<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<section xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xi="http://www.w3.org/2001/XInclude" version="5.1">
  <title>Contributing Guide</title>
  <para>First and foremost, thank you for wanting to contribute! It’s the only way
            open source works!</para>
  <para>Before you dive into writing patches, here are some of the basics:</para>
  <itemizedlist>
    <listitem>
      <para>Project page: <link xlink:href="http://launchpad.net/horizon"/></para>
    </listitem>
    <listitem>
      <para>Bug tracker: <link xlink:href="https://bugs.launchpad.net/horizon"/></para>
    </listitem>
    <listitem>
      <para>Source code: <link xlink:href="https://github.com/openstack/horizon"/></para>
    </listitem>
    <listitem>
      <para>Code review: <link xlink:href="https://review.openstack.org/#q,status:open+project:openstack/horizon,n,z"/></para>
    </listitem>
    <listitem>
      <para>Continuous integration:
                    * Jenkins: <link xlink:href="https://jenkins.openstack.org"/>
                    * Zuul: <link xlink:href="http://status.openstack.org/zuul"/></para>
    </listitem>
    <listitem>
      <para>IRC Channel: #openstack-horizon on Freenode.</para>
    </listitem>
  </itemizedlist>
  <section>
    <title>Making Contributions</title>
    <section>
      <title>Getting Started</title>
      <para>We’ll start by assuming you’ve got a working checkout of the repository (if
                    not then please see the <xref linkend="quickstart"/>).</para>
      <para>Second, you’ll need to take care of a couple administrative tasks:</para>
      <procedure>
        <step>
          <para>Create an account on Launchpad.</para>
        </step>
        <step>
          <para>Sign the <link xlink:href="http://wiki.openstack.org/CLA">OpenStack Contributor License Agreement</link> and follow the associated
                            instructions to verify your signature.</para>
        </step>
        <step>
          <para>Join the <link xlink:href="https://launchpad.net/~horizon">Horizon Developers</link> team on Launchpad.</para>
        </step>
        <step>
          <para>Follow the <link xlink:href="https://docs.openstack.org/infra/manual/developers.html#development-workflow">instructions for setting up git-review</link> in your
                            development environment.</para>
        </step>
      </procedure>
      <para>Whew! Got all that? Okay! You’re good to go.</para>
    </section>
    <section>
      <title>Ways To Contribute</title>
      <para>The easiest way to get started with Horizon’s code is to pick a bug on
                    Launchpad that interests you, and start working on that. Bugs tagged as
                    <literal>low-hanging-fruit</literal> are a good place to start. Alternatively, if there’s an
                    OpenStack API feature you would like to see implemented in Horizon feel free
                    to try building it.</para>
      <para>If those are too big, there are lots of great ways to get involved without
                    plunging in head-first:</para>
      <itemizedlist>
        <listitem>
          <para>Report bugs, triage new tickets, and review old tickets on
                            the <link xlink:href="https://bugs.launchpad.net/horizon">bug tracker</link>.</para>
        </listitem>
        <listitem>
          <para>Propose ideas for improvements via <link xlink:href="https://blueprints.launchpad.net/horizon">Launchpad Blueprints</link>, via the
                            mailing list on the project page, or on IRC.</para>
        </listitem>
        <listitem>
          <para>Write documentation!</para>
        </listitem>
        <listitem>
          <para>Write unit tests for untested code!</para>
        </listitem>
        <listitem>
          <para>Help improve the <link xlink:href="https://wiki.openstack.org/wiki/UX#Getting_Started">User Experience Design</link> or contribute to the
                            <link xlink:href="https://wiki.openstack.org/wiki/Personas">Persona Working Group</link>.</para>
        </listitem>
      </itemizedlist>
    </section>
    <section>
      <title>Choosing Issues To Work On</title>
      <para>In general, if you want to write code, there are three cases for issues
                    you might want to work on:</para>
      <procedure>
        <step>
          <para>Confirmed bugs</para>
        </step>
        <step>
          <para>Approved blueprints (features)</para>
        </step>
        <step>
          <para>New bugs you’ve discovered</para>
        </step>
      </procedure>
      <para>If you have an idea for a new feature that isn’t in a blueprint yet, it’s
                    a good idea to write the blueprint first, so you don’t end up writing a bunch
                    of code that may not go in the direction the community wants.</para>
      <para>For bugs, open the bug first, but if you can reproduce the bug reliably and
                    identify its cause then it’s usually safe to start working on it. However,
                    getting independent confirmation (and verifying that it’s not a duplicate)
                    is always a good idea if you can be patient.</para>
    </section>
    <section>
      <title>After You Write Your Patch</title>
      <para>Once you’ve made your changes, there are a few things to do:</para>
      <itemizedlist>
        <listitem>
          <para>Make sure the unit tests and linting tasks pass by running <literal>tox</literal></para>
        </listitem>
        <listitem>
          <para>Take a look at your patch in API profiler, i.e. how it impacts the
                            performance. See <xref linkend="profiling-pages"/>.</para>
        </listitem>
        <listitem>
          <para>Make sure your code is ready for translation: See <xref linkend="pseudo-translation"/>.</para>
        </listitem>
        <listitem>
          <para>Make sure your code is up-to-date with the latest master:
                            <literal>git pull --rebase</literal></para>
        </listitem>
        <listitem>
          <para>Finally, run <literal>git review</literal> to upload your changes to Gerrit for review.</para>
        </listitem>
      </itemizedlist>
      <para>The Horizon core developers will be notified of the new review and will examine
                    it in a timely fashion, either offering feedback or approving it to be merged.
                    If the review is approved, it is sent to Jenkins to verify the unit tests pass
                    and it can be merged cleanly. Once Jenkins approves it, the change will be
                    merged to the master repository and it’s time to celebrate!</para>
    </section>
    <section xml:id="profiling-pages">
      <title>Profiling Pages</title>
      <para>In the Ocata release of Horizon a new “OpenStack Profiler” panel was
                    introduced. Once it is enabled and all prerequisites are set up, you can see
                    which API calls Horizon actually makes when rendering a specific page. To
                    re-render the page while profiling it, you’ll need to use the “Profile”
                    dropdown menu located in the top right corner of the screen. In order to
                    be able to use “Profile” menu, the following steps need to be completed:</para>
      <procedure>
        <step>
          <para>Enable the Developer dashboard by copying <literal>_9001_developer.py</literal> from
                            <literal>openstack_dashboard/contrib/developer/enabled/</literal> to
                            <literal>openstack_dashboard/local/enabled/</literal>.</para>
        </step>
        <step>
          <para>Copy
                            <literal>openstack_dashboard/local/local_settings.d/_9030_profiler_settings.py.example</literal>
                            to <literal>openstack_dashboard/local/local_settings.d/_9030_profiler_settings.py</literal></para>
        </step>
        <step>
          <para>Copy <literal>openstack_dashboard/contrib/developer/enabled/_9030_profiler.py</literal> to
                            <literal>openstack_dashboard/local/enabled/_9030_profiler.py</literal>.</para>
        </step>
        <step>
          <para>To support storing profiler data on server-side, MongoDB cluster needs to be
                            installed on your Devstack host (default configuration), see
                            <link xlink:href="https://docs.mongodb.com/manual/tutorial/install-mongodb-on-ubuntu/#install-mongodb-community-edition">Installing MongoDB</link>. Then, change the <literal>bindIp</literal> key in
                            <literal>/etc/mongod.conf</literal> to <literal>0.0.0.0</literal> and invoke
                            <literal>sudo service mongod restart</literal>.</para>
        </step>
        <step>
          <para>Collect and compress static assets with
                            <literal>tox -e manage -- collectstatic -c</literal> and <literal>tox -e manage -- compress</literal></para>
        </step>
        <step>
          <para>Restart the web server.</para>
        </step>
        <step>
          <para>The “Profile” drop-down menu should appear in the top-right corner, you are
                            ready to profile your pages!</para>
        </step>
      </procedure>
    </section>
  </section>
  <section>
    <title>Etiquette</title>
    <para>The community’s guidelines for etiquette are fairly simple:</para>
    <itemizedlist>
      <listitem>
        <para>Treat everyone respectfully and professionally.</para>
      </listitem>
      <listitem>
        <para>If a bug is “in progress” in the bug tracker, don’t start working on it
                        without contacting the author. Try on IRC, or via the launchpad email
                        contact link. If you don’t get a response after a reasonable time, then go
                        ahead. Checking first avoids duplicate work and makes sure nobody’s toes
                        get stepped on.</para>
      </listitem>
      <listitem>
        <para>If a blueprint is assigned, even if it hasn’t been started, be sure you
                        contact the assignee before taking it on. These larger issues often have a
                        history of discussion or specific implementation details that the assignee
                        may be aware of that you are not.</para>
      </listitem>
      <listitem>
        <para>Please don’t re-open tickets closed by a core developer. If you disagree with
                        the decision on the ticket, the appropriate solution is to take it up on
                        IRC or the mailing list.</para>
      </listitem>
      <listitem>
        <para>Give credit where credit is due; if someone helps you substantially with
                        a piece of code, it’s polite (though not required) to thank them in your
                        commit message.</para>
      </listitem>
    </itemizedlist>
  </section>
  <section>
    <title>Code Style</title>
    <para>As a project, Horizon adheres to code quality standards.</para>
    <section>
      <title>Python</title>
      <para>We follow <link xlink:href="http://www.python.org/dev/peps/pep-0008/">PEP8</link> for all our Python code, and use <literal>pep8.py</literal> (available
                    via the shortcut <literal>tox -e pep8</literal>) to validate that our code
                    meets proper Python style guidelines.</para>
    </section>
    <section>
      <title>Django</title>
      <para>Additionally, we follow <link xlink:href="https://docs.djangoproject.com/en/dev/internals/contributing/writing-code/coding-style/">Django’s style guide</link> for templates, views, and
                    other miscellany.</para>
    </section>
    <section>
      <title>JavaScript</title>
      <para>The following standards are divided into required and recommended sections.
                    Our main goal in establishing these best practices is to have code that is
                    reliable, readable, and maintainable.</para>
      <section>
        <title>Required</title>
        <para>
          <emphasis role="bold">Reliable</emphasis>
        </para>
        <itemizedlist>
          <listitem>
            <para>The code has to work on the stable and latest versions of Firefox, Chrome,
                                Safari, and Opera web browsers, and on Microsoft Internet Explorer 11 and
                                later.</para>
          </listitem>
          <listitem>
            <para>If you turned compression off during development via <literal>COMPRESS_ENABLED =
False</literal> in local_settings.py, re-enable compression and test your code
                                before submitting.</para>
          </listitem>
          <listitem>
            <para>Use <literal>===</literal> as opposed to <literal>==</literal> for equality checks. The <literal>==</literal> will do a
                                type cast before comparing, which can lead to unwanted results.</para>
            <note>
              <para>If typecasting is desired, explicit casting is preferred to keep the
                                    meaning of your code clear.</para>
            </note>
          </listitem>
          <listitem>
            <para>Keep document reflows to a minimum. DOM manipulation is expensive, and can
                                become a performance issue. If you are accessing the DOM, make sure that you
                                are doing it in the most optimized way. One example is to build up a document
                                fragment and then append the fragment to the DOM in one pass instead of doing
                                multiple smaller DOM updates.</para>
          </listitem>
          <listitem>
            <para>Use “strict”, enclosing each JavaScript file inside a self-executing
                                function. The self-executing function keeps the strict scoped to the file,
                                so its variables and methods are not exposed to other JavaScript files in
                                the product.</para>
            <note>
              <para>Using strict will throw exceptions for common coding errors, like
                                    accessing global vars, that normally are not flagged.</para>
            </note>
            <para>Example:</para>
            <screen>(function(){
  'use strict';
  // code...
})();</screen>
          </listitem>
          <listitem>
            <para>Use <literal>forEach</literal> | <literal>each</literal> when looping whenever possible. AngularJS and
                                jQuery both provide for each loops that provide both iteration and scope.</para>
            <para>AngularJS:</para>
            <screen>angular.forEach(objectToIterateOver, function(value, key) {
  // loop logic
});</screen>
            <para>jQuery:</para>
            <screen>$.each(objectToIterateOver, function(key, value) {
  // loop logic
});</screen>
          </listitem>
          <listitem>
            <para>Do not put variables or functions in the global namespace. There are several
                                reasons why globals are bad, one being that all JavaScript included in an
                                application runs in the same scope. The issue with that is if another script
                                has the same method or variable names they overwrite each other.</para>
          </listitem>
          <listitem>
            <para>Always put <literal>var</literal> in front of your variables. Not putting <literal>var</literal> in front
                                of a variable puts that variable into the global space, see above.</para>
          </listitem>
          <listitem>
            <para>Do not use <literal>eval( )</literal>. The eval (expression) evaluates the expression
                                passed to it. This can open up your code to security vulnerabilities and
                                other issues.</para>
          </listitem>
          <listitem>
            <para>Do not use ‘<literal>with</literal> object {code}’. The <literal>with</literal> statement is used to access
                                properties of an object. The issue with <literal>with</literal> is that its execution is not
                                consistent, so by reading the statement in the code it is not always clear
                                how it is being used.</para>
          </listitem>
        </itemizedlist>
        <para>
          <emphasis role="bold">Readable &amp; Maintainable</emphasis>
        </para>
        <itemizedlist>
          <listitem>
            <para>Give meaningful names to methods and variables.</para>
          </listitem>
          <listitem>
            <para>Avoid excessive nesting.</para>
          </listitem>
          <listitem>
            <para>Avoid HTML and CSS in JS code. HTML and CSS belong in templates and
                                stylesheets respectively. For example:</para>
            <itemizedlist>
              <listitem>
                <para>In our HTML files, we should focus on layout.</para>
                <procedure>
                  <step>
                    <para>Reduce the small/random <literal>&lt;script&gt;</literal> and <literal>&lt;style&gt;</literal> elements in HTML.</para>
                  </step>
                  <step>
                    <para>Avoid in-lining styles into element in HTML. Use attributes and
                                                classes instead.</para>
                  </step>
                </procedure>
              </listitem>
              <listitem>
                <para>In our JS files, we should focus on logic rather than attempting to
                                        manipulate/style elements.</para>
                <procedure>
                  <step>
                    <para>Avoid statements such as <literal>element.css({property1,property2...})</literal> they
                                                belong in a CSS class.</para>
                  </step>
                  <step>
                    <para>Avoid statements such as <literal>$("&lt;div&gt;&lt;span&gt;abc&lt;/span&gt;&lt;/div&gt;")</literal> they
                                                belong in a HTML template file. Use <literal>show</literal> | <literal>hide</literal> | <literal>clone</literal>
                                                elements if dynamic content is required.</para>
                  </step>
                  <step>
                    <para>Avoid using classes for detection purposes only, instead, defer to
                                                attributes. For example to find a div:</para>
                    <screen language="html">&lt;div class="something"&gt;&lt;/div&gt;
  $(".something").html("Don't find me this way!");</screen>
                    <para>is better found like:</para>
                    <screen language="html">&lt;div data-something&gt;&lt;/div&gt;
  $("div[data-something]").html("You found me correctly!");</screen>
                  </step>
                </procedure>
              </listitem>
            </itemizedlist>
          </listitem>
          <listitem>
            <para>Avoid commented-out code.</para>
          </listitem>
          <listitem>
            <para>Avoid dead code.</para>
          </listitem>
        </itemizedlist>
        <para>
          <emphasis role="bold">Performance</emphasis>
        </para>
        <itemizedlist>
          <listitem>
            <para>Avoid creating instances of the same object repeatedly within the same scope.
                                Instead, assign the object to a variable and re-use the existing object. For
                                example:</para>
            <screen>$(document).on('click', function() { /* do something. */ });
$(document).on('mouseover', function() { /* do something. */ });</screen>
            <para>A better approach:</para>
            <screen>var $document = $(document);
$document.on('click', function() { /* do something. */ });
$document.on('mouseover', function() { /* do something. */ });</screen>
            <para>In the first approach a jQuery object for <literal>document</literal> is created each time.
                                The second approach creates only one jQuery object and reuses it. Each object
                                needs to be created, uses memory, and needs to be garbage collected.</para>
          </listitem>
        </itemizedlist>
      </section>
      <section>
        <title>Recommended</title>
        <para>
          <emphasis role="bold">Readable &amp; Maintainable</emphasis>
        </para>
        <itemizedlist>
          <listitem>
            <para>Put a comment at the top of every file explaining what the purpose of this
                                file is when the naming is not obvious. This guideline also applies to
                                methods and variables.</para>
          </listitem>
          <listitem>
            <para>Source-code formatting – (or “beautification”) is recommended but should be
                                used with caution. Keep in mind that if you reformat an entire file that was
                                not previously formatted the same way, it will mess up the diff during the
                                code review. It is best to use a formatter when you are working on a new file
                                by yourself, or with others who are using the same formatter. You can also
                                choose to format a selected portion of a file only. Instructions for setting
                                up ESLint for Eclipse, Sublime Text, Notepad++ and WebStorm/PyCharm are
                                <link xlink:href="https://wiki.openstack.org/wiki/Horizon/Javascript/EditorConfig">provided</link>.</para>
          </listitem>
          <listitem>
            <para>Use 2 spaces for code indentation.</para>
          </listitem>
          <listitem>
            <para>Use <literal>{ }</literal> for <literal>if</literal>, <literal>for</literal>, <literal>while</literal> statements, and don’t combine them
                                on one line.</para>
            <screen>// Do this          //Not this          // Not this
if(x) {             if(x)               if(x) y =x;
  y=x;                y=x;
}</screen>
          </listitem>
          <listitem>
            <para>Use ESLint in your development environment.</para>
          </listitem>
        </itemizedlist>
      </section>
    </section>
    <section>
      <title>AngularJS</title>
      <note>
        <para>This section is intended as a quick intro to contributing with AngularJS. For
                        more detailed information, check the <xref linkend="topics-angularjs"/>.</para>
      </note>
      <section>
        <title>“John Papa Style Guide”</title>
        <para>The John Papa Style Guide is the primary point of reference for Angular
                        code style. This style guide has been endorsed by the AngularJS
                        team:</para>
        <screen>"The most current and detailed Angular Style Guide is the
community-driven effort led by John Papa and Todd Motto."

- http://angularjs.blogspot.com/2014/02/an-angularjs-style-guide-and-best.html</screen>
        <para>The style guide is found at the below location:</para>
        <para>
          <link xlink:href="https://github.com/johnpapa/angular-styleguide"/>
        </para>
        <para>When reviewing / writing, please refer to the sections of this guide.
                        If an issue is encountered, note it with a comment and provide a link back
                        to the specific issue. For example, code should use named functions. A
                        review noting this should provide the following link in the comments:</para>
        <para>
          <link xlink:href="https://github.com/johnpapa/angular-styleguide#style-y024"/>
        </para>
        <para>In addition to John Papa, the following guidelines are divided into
                        required and recommended sections.</para>
      </section>
      <section>
        <title>Required</title>
        <itemizedlist>
          <listitem>
            <para>Scope is not the model (model is your JavaScript Objects). The scope
                                references the model. Use isolate scopes wherever possible.</para>
            <itemizedlist>
              <listitem>
                <para>
                  <link xlink:href="https://github.com/angular/angular.js/wiki/Understanding-Scopes"/>
                </para>
              </listitem>
              <listitem>
                <para>Read-only in templates.</para>
              </listitem>
              <listitem>
                <para>Write-only in controllers.</para>
              </listitem>
            </itemizedlist>
          </listitem>
          <listitem>
            <para>Since Django already uses <literal>{{ }}</literal>, use <literal>{$ $}</literal> or <literal>{% verbatim %}</literal>
                                instead.</para>
          </listitem>
        </itemizedlist>
      </section>
    </section>
    <section>
      <title>ESLint</title>
      <para>ESLint is a great tool to be used during your code editing to improve
                    JavaScript quality by checking your code against a configurable list of checks.
                    Therefore, JavaScript developers should configure their editors to use ESLint
                    to warn them of any such errors so they can be addressed. Since ESLint has a
                    ton of configuration options to choose from, links are provided below to the
                    options Horizon wants enforced along with the instructions for setting up
                    ESLint for Eclipse, Sublime Text, Notepad++ and WebStorm/PyCharm.</para>
      <para>Instructions for setting up ESLint: <link xlink:href="https://wiki.openstack.org/wiki/Horizon/Javascript/EditorConfig">ESLint setup instructions</link></para>
      <note>
        <para>ESLint is part of the automated unit tests performed by Jenkins. The
                        automated test use the default configurations, which are less strict than
                        the configurations we recommended to run in your local development
                        environment.</para>
      </note>
    </section>
    <section>
      <title>CSS</title>
      <para>Style guidelines for CSS are currently quite minimal. Do your best to make the
                    code readable and well-organized. Two spaces are preferred for indentation
                    so as to match both the JavaScript and HTML files.</para>
    </section>
    <section>
      <title>JavaScript and CSS libraries using xstatic</title>
      <para>We do not bundle third-party code in Horizon’s source tree. Instead, we package
                    the required files as xstatic Python packages and add them as dependencies to
                    Horizon.</para>
      <para>To create a new xstatic package:</para>
      <procedure>
        <step>
          <para>Check if the library is already packaged as xstatic on PyPi, by searching
                            for the library name. If it already is, go to step 5. If it is, but not in
                            the right version, contact the original packager to have them update it.</para>
        </step>
        <step>
          <para>Package the library as an xstatic package by following the instructions in
                            xstatic <link xlink:href="http://xstatic.rtfd.org/en/latest/packaging.html">documentation</link>. Install the <link xlink:href="https://pypi.python.org/pypi/xstatic-release">xstatic-release</link> script and follow
                            the instructions that come with it.</para>
        </step>
        <step>
          <para><link xlink:href="https://docs.openstack.org/infra/manual/creators.html">Create a new repository under OpenStack</link>. Use “xstatic-core” and
                            “xstatic-ptl” groups for the ACLs. Make sure to include the
                            <literal>-pypi-wheel-upload</literal> job in the project config.</para>
        </step>
        <step>
          <para><link xlink:href="https://docs.openstack.org/infra/manual/creators.html#give-openstack-permission-to-publish-releases">Set up PyPi</link> to allow OpenStack (the “openstackci” user) to publish your
                            package.</para>
        </step>
        <step>
          <para>Add the new package to <link xlink:href="https://github.com/openstack/requirements/blob/master/global-requirements.txt">global-requirements</link>.</para>
        </step>
      </procedure>
      <para>To make a new release of the package, you need to:</para>
      <procedure>
        <step>
          <para>Ensure the version information in the
                            <literal>xstatic/pkg/&lt;package name&gt;/__init__.py</literal> file is up to date,
                            especially the <literal>BUILD</literal>.</para>
        </step>
        <step>
          <para>Push your updated package up for review in gerrit.</para>
        </step>
        <step>
          <para>Once the review is approved and the change merged, <link xlink:href="http://git.openstack.org/cgit/openstack/releases/tree/README.rst">request a release</link> by
                            updating or creating the appropriate file for the xstatic package
                            in the <link xlink:href="http://git.openstack.org/cgit/openstack/releases">releases repository</link> under <literal>deliverables/_independent</literal>. That
                            will cause it to be automatically packaged and released to PyPi.</para>
        </step>
      </procedure>
      <warning>
        <para>Note that once a package is released, you can not “un-release” it. You
                        should never attempt to modify, delete or rename a released package without
                        a lot of careful planning and feedback from all projects that use it.</para>
        <para>For the purpose of fixing packaging mistakes, xstatic has the build number
                        mechanism. Simply fix the error, increment the build number and release the
                        newer package.</para>
      </warning>
      <section>
        <title>Integrating a new xstatic package into Horizon</title>
        <para>Having done a release of an xstatic package:</para>
        <procedure>
          <step>
            <para>Look for the <link xlink:href="https://git.openstack.org/cgit/openstack/requirements/plain/upper-constraints.txt">upper-constraints.txt</link> edit related to the xstatic release
                                that was just performed. One will be created automatically by the release
                                process in the <literal>openstack/requirements</literal> project with the topic
                                <link xlink:href="https://review.openstack.org/#/q/status:open+project:openstack/requirements+branch:master+topic:new-release">new-release</link>. You should -1 that patch until you are confident Horizon
                                does not break (or you have generated a patch to fix Horizon for that
                                release.) If no upper-constraints.txt patch is automatically generated,
                                ensure the releases yaml file created in the <link xlink:href="http://git.openstack.org/cgit/openstack/releases">releases repository</link> has the
                                “include-pypi-link: yes” setting.</para>
          </step>
          <step>
            <para>Pull that patch down so you have the edited upper-constraints.txt file
                                locally.</para>
          </step>
          <step>
            <para>Set the environment variable <literal>UPPER_CONSTRAINTS_FILE</literal> to the edited
                                upper-constraints.txt file name and run tests or local development server
                                through tox. This will pull in the precise version of the xstatic package
                                that you need.</para>
          </step>
          <step>
            <para>Move on to releasing once you’re happy the Horizon changes are stable.</para>
          </step>
        </procedure>
        <para>Releasing a new compatible version of Horizon to address issues in the new
                        xstatic release:</para>
        <procedure>
          <step>
            <para>Continue to -1 the upper-constraints.txt patch above until this process is
                                complete. A +1 from a Horizon developer will indicate to the requirements
                                team that the upper-constraints.txt patch is OK to merge.</para>
          </step>
          <step>
            <para>When submitting your changes to Horizon to address issues around the new
                                xstatic release, use a Depends-On: referencing the upper-constraints.txt
                                review. This will cause the OpenStack testing infrastructure to pull in your
                                updated xstatic package as well.</para>
          </step>
          <step>
            <para>Merge the upper-constraints.txt patch and the Horizon patch noting that
                                Horizon’s gate may be broken in the interim between these steps, so try to
                                minimise any delay there. With the Depends-On it’s actually safe to +W the
                                Horizon patch, which will be held up until the related upper-constraints.txt
                                patch merges.</para>
          </step>
          <step>
            <para>Once the upper-constraints.txt patch merges, you should propose a patch to
                                global-requirements which bumps the minimum version of the package up to the
                                upper-constraints version so that deployers / packagers who don’t honor
                                upper-constraints still get compatible versions of the packages.</para>
          </step>
        </procedure>
      </section>
    </section>
    <section>
      <title>HTML</title>
      <para>Again, readability is paramount; however be conscientious of how the browser
                    will handle whitespace when rendering the output. Two spaces is the preferred
                    indentation style to match all front-end code.</para>
    </section>
    <section>
      <title>Exception Handling</title>
      <para>Avoid propogating direct exception messages thrown by OpenStack APIs to the UI.
                    It is a precaution against giving obscure or possibly sensitive data to a user.
                    These error messages from the API are also not translatable. Until there is a
                    standard error handling framework implemented by the services which presents
                    clean and translated messages, horizon catches all the exceptions thrown by the
                    API and normalizes them in <xref linkend="horizon.exceptions.handle"/>.</para>
    </section>
    <section>
      <title>Documentation</title>
      <para>Horizon’s documentation is written in reStructuredText (reST) and uses Sphinx
                    for additional parsing and functionality, and should follow standard practices
                    for writing reST. This includes:</para>
      <itemizedlist>
        <listitem>
          <para>Flow paragraphs such that lines wrap at 80 characters or less.</para>
        </listitem>
        <listitem>
          <para>Use proper grammar, spelling, capitalization and punctuation at all times.</para>
        </listitem>
        <listitem>
          <para>Make use of Sphinx’s autodoc feature to document modules, classes
                            and functions. This keeps the docs close to the source.</para>
        </listitem>
        <listitem>
          <para>Where possible, use Sphinx’s cross-reference syntax (e.g.
                            <literal>:class:`~horizon.foo.Bar</literal>) when referring to other Horizon components.
                            The better-linked our docs are, the easier they are to use.</para>
        </listitem>
      </itemizedlist>
      <para>Be sure to generate the documentation before submitting a patch for review.
                    Unexpected warnings often appear when building the documentation, and slight
                    reST syntax errors frequently cause links or cross-references not to work
                    correctly.</para>
      <para>Documentation is generated with Sphinx using the tox command. To create HTML
                    docs and man pages:</para>
      <screen language="bash">$ tox -e docs</screen>
      <para>The results are in the doc/build/html and doc/build/man directories
                    respectively.</para>
    </section>
    <section>
      <title>Conventions</title>
      <para>Simply by convention, we have a few rules about naming:</para>
      <itemizedlist>
        <listitem>
          <para>The term “project” is used in place of Keystone’s “tenant” terminology
                            in all user-facing text. The term “tenant” is still used in API code to
                            make things more obvious for developers.</para>
        </listitem>
        <listitem>
          <para>The term “dashboard” refers to a top-level dashboard class, and “panel” to
                            the sub-items within a dashboard. Referring to a panel as a dashboard is
                            both confusing and incorrect.</para>
        </listitem>
      </itemizedlist>
    </section>
  </section>
  <section>
    <title>Release Notes</title>
    <para>Release notes for a patch should be included in the patch with the
                associated changes whenever possible. This allow for simpler tracking. It also
                enables a single cherry pick to be done if the change is backported to a
                previous release. In some cases, such as a feature that is provided via
                multiple patches, release notes can be done in a follow-on review.</para>
    <para>If the following applies to the patch, a release note is required:</para>
    <itemizedlist>
      <listitem>
        <para>The deployer needs to take an action when upgrading</para>
      </listitem>
      <listitem>
        <para>A new feature is implemented</para>
      </listitem>
      <listitem>
        <para>Function was removed (hopefully it was deprecated)</para>
      </listitem>
      <listitem>
        <para>Current behavior is changed</para>
      </listitem>
      <listitem>
        <para>A new config option is added that the deployer should consider changing from
                        the default</para>
      </listitem>
      <listitem>
        <para>A security bug is fixed</para>
      </listitem>
    </itemizedlist>
    <note>
      <itemizedlist>
        <listitem>
          <para>A release note is suggested if a long-standing or important bug is fixed.
                            Otherwise, a release note is not required.</para>
        </listitem>
        <listitem>
          <para>It is not recommended that individual release notes use <emphasis role="bold">prelude</emphasis>
                            section as it is for release highlights.</para>
        </listitem>
      </itemizedlist>
    </note>
    <warning>
      <para>Avoid modifying an existing release note file even though it is related to
                    your change. If you modify a release note file of a past release, the whole
                    content will be shown in a latest release. The only allowed case is to
                    update a release note in a same release.</para>
      <para>If you need to update a release note of a past release, edit a corresponding
                    release note file in a stable branch directly.</para>
    </warning>
    <para>Horizon uses <link xlink:href="https://docs.openstack.org/reno/latest/user/usage.html">reno</link> to
                generate release notes. Please read the docs for details. In summary, use</para>
    <screen language="bash">$ tox -e venv -- reno new &lt;bug-,bp-,whatever&gt;</screen>
    <para>Then edit the sample file that was created and push it with your change.</para>
    <para>To see the results:</para>
    <screen language="bash">$ git commit  # Commit the change because reno scans git log.

$ tox -e releasenotes</screen>
    <para>Then look at the generated release notes files in releasenotes/build/html in
                your favorite browser.</para>
  </section>
  <section>
    <title>Core Reviewer Team</title>
    <para>The Horizon Core Reviewer Team is responsible for many aspects of the
                Horizon project. These include, but are not limited to:</para>
    <itemizedlist>
      <listitem>
        <para>Mentor community contributors in solution design, testing, and the
                        review process</para>
      </listitem>
      <listitem>
        <para>Actively reviewing patch submissions, considering whether the patch:
                        - is functional
                        - fits the use-cases and vision of the project
                        - is complete in terms of testing, documentation, and release notes
                        - takes into consideration upgrade concerns from previous versions</para>
      </listitem>
      <listitem>
        <para>Assist in bug triage and delivery of bug fixes</para>
      </listitem>
      <listitem>
        <para>Curating the gate and triaging failures</para>
      </listitem>
      <listitem>
        <para>Maintaining accurate, complete, and relevant documentation</para>
      </listitem>
      <listitem>
        <para>Ensuring the level of testing is adequate and remains relevant as
                        features are added</para>
      </listitem>
      <listitem>
        <para>Answering questions and participating in mailing list discussions</para>
      </listitem>
      <listitem>
        <para>Interfacing with other OpenStack teams</para>
      </listitem>
    </itemizedlist>
    <para>In essence, core reviewers share the following common ideals:</para>
    <itemizedlist>
      <listitem>
        <para>They share responsibility in the project’s success in its mission.</para>
      </listitem>
      <listitem>
        <para>They value a healthy, vibrant, and active developer and user community.</para>
      </listitem>
      <listitem>
        <para>They have made a long-term, recurring time investment to improve the project.</para>
      </listitem>
      <listitem>
        <para>They spend their time doing what needs to be done to ensure the
                        project’s success, not necessarily what is the most interesting or
                        fun.</para>
      </listitem>
      <listitem>
        <para>A core reviewer’s responsibility doesn’t end with merging code.</para>
      </listitem>
    </itemizedlist>
    <section>
      <title>Core Reviewer Expectations</title>
      <para>Members of the core reviewer team are expected to:</para>
      <itemizedlist>
        <listitem>
          <para>Attend and participate in the weekly IRC meetings (if your timezone allows)</para>
        </listitem>
        <listitem>
          <para>Monitor and participate in-channel at #openstack-horizon</para>
        </listitem>
        <listitem>
          <para>Monitor and participate in [Horizon] discussions on the mailing list</para>
        </listitem>
        <listitem>
          <para>Participate in related design summit sessions at the OpenStack
                            Summits and Project Team Gatherings</para>
        </listitem>
        <listitem>
          <para>Review patch submissions actively and consistently</para>
        </listitem>
      </itemizedlist>
      <para>Please note in-person attendance at design summits, mid-cycles, and
                    other code sprints is not a requirement to be a core reviewer.
                    Participation can also include contributing to the design documents
                    discussed at the design sessions.</para>
      <para>Active and consistent review of review activity, bug triage and other
                    activity will be performed monthly and fed back to the Core Reviewer Team
                    so everyone knows how things are progressing.</para>
    </section>
    <section>
      <title>Code Merge Responsibilities</title>
      <para>While everyone is encouraged to review changes, members of the core
                    reviewer team have the ability to +2/-2 and +A changes to these
                    repositories. This is an extra level of responsibility not to be taken
                    lightly. Correctly merging code requires not only understanding the
                    code itself, but also how the code affects things like documentation,
                    testing, upgrade impacts and interactions with other projects. It also
                    means you pay attention to release milestones and understand if a
                    patch you are merging is marked for the release, especially critical
                    during the feature freeze.</para>
    </section>
  </section>
</section>
