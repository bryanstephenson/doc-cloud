<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<section xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xi="http://www.w3.org/2001/XInclude" version="5.1">
  <title>Contributing Documentation to Cinder</title>
  <para>Starting with the Pike release, Cinder’s documentation has been moved from
            the openstack-manuals repository to the <literal>docs</literal> directory in the Cinder
            repository.  This makes it even more important that Cinder add and
            maintain good documentation.</para>
  <note>
    <para>Documentation for python-cinderclient and os-brick has undergone the
                same transition.  The information here can be applied for those
                projects as well.</para>
  </note>
  <para>This page provides guidance on how to provide documentation for those
            who may not have previously been active writing documentation for
            OpenStack.</para>
  <section>
    <title>Using RST</title>
    <para>OpenStack documentation uses reStructuredText to write documentation.
                The files end with a <literal>.rst</literal> extension.  The <literal>.rst</literal> files are then
                processed by Sphinx to build HTML based on the RST files.</para>
    <note>
      <para>Files that are to be included using the <literal>.. include::</literal> directive in an
                    RST file should use the <literal>.inc</literal> extension.  If you instead use the <literal>.rst</literal>
                    this will result in the RST file being processed twice during the build and
                    cause Sphinx to generate a warning during the build.</para>
    </note>
    <para>reStructuredText is a powerful language for generating web pages.  The
                documentation team has put together an <link xlink:href="https://docs.openstack.org/contributor-guide/rst-conv.html">RST conventions</link> page with information
                and links related to RST.</para>
  </section>
  <section>
    <title>Building Cinder’s Documentation</title>
    <para>To build documentation the following command should be used:</para>
    <screen language="console">tox -e docs,pep8</screen>
    <para>When building documentation it is important to also run pep8 as it is easy
                to introduce pep8 failures when adding documentation.  Currently, we do not
                have the build configured to treat warnings as errors, so it is also important
                to check the build output to ensure that no warnings are produced by Sphinx.</para>
    <note>
      <para>Many Sphinx warnings result in improperly formatted pages being generated.</para>
    </note>
    <para>During the documentation build a number of things happen:</para>
    <itemizedlist>
      <listitem>
        <para>All of the RST files under <literal>doc/source</literal> are processed and built.</para>
        <itemizedlist>
          <listitem>
            <para>The openstackdocs theme is applied to all of the files so that they
                                        will look consistent with all the other OpenStack documentation.</para>
          </listitem>
          <listitem>
            <para>The resulting HTML is put into <literal>doc/build/html</literal>.</para>
          </listitem>
        </itemizedlist>
      </listitem>
      <listitem>
        <para>Sample files like cinder.conf.sample are generated and put into <literal>doc/soure/_static</literal>.</para>
      </listitem>
      <listitem>
        <para>All of Cinder’s <literal>.py</literal> files are processed and the docstrings are used to
                            generate the files under <literal>doc/source/contributor/api</literal></para>
      </listitem>
    </itemizedlist>
    <para>After the build completes the results may be accessed via a web browser in
                the <literal>doc/build/html</literal> directory structure.</para>
  </section>
  <section>
    <title>Review and Release Process</title>
    <para>Documentation changes go through the same review process as all other changes.</para>
    <note>
      <para>Reviewers can see the resulting web page output by clicking on
                    <literal>gate-cinder-docs-ubuntu-xenial</literal>!</para>
    </note>
    <para>Once a patch is approved it is immediately released to the docs.openstack.org
                website and can be seen under Cinder’s Documentation Page at
                <link xlink:href="https://docs.openstack.org/cinder/latest"/> .  When a new release is cut a
                snapshot of that documentation will be kept at
                <link xlink:href="https://docs.openstack.org/cinder"/>/&lt;release&gt; .  Changes from master can be
                backported to previous branches if necessary.</para>
  </section>
  <section>
    <title>Doc Directory Structure</title>
    <para>The main location for Cinder’s documentation is the <literal>doc/source</literal> directory.
                The top level index file that is seen at
                <link xlink:href="https://docs.openstack/org/cinder/latest"/> resides here as well as the
                <literal>conf.py</literal> file which is used to set a number of parameters for the build
                of OpenStack’s documentation.</para>
    <para>Each of the directories under source are for specific kinds of documentation
                as is documented in the <literal>README</literal> in each directory:</para>
    <xi:include href="contributor-documentation...xml"/>
    <xi:include href="contributor-documentation...xml"/>
    <xi:include href="contributor-documentation...xml"/>
    <xi:include href="contributor-documentationREADME.xml"/>
    <xi:include href="contributor-documentation...xml"/>
    <xi:include href="contributor-documentation...xml"/>
    <xi:include href="contributor-documentation...xml"/>
  </section>
</section>
