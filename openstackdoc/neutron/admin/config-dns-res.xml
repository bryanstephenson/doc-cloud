<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.13.1 -->
<document source="/home/fbaumanis/openstack/soc8_test/openstack_repo/neutron/doc/source/admin/config-dns-res.rst">
    <target refid="config-dns-res"></target>
    <section ids="name-resolution-for-instances config-dns-res" names="name\ resolution\ for\ instances config-dns-res">
        <title>Name resolution for instances</title>
        <paragraph>The Networking service offers several methods to configure name
            resolution (DNS) for instances. Most deployments should implement
            case 1 or 2. Case 3 requires security considerations to prevent
            leaking internal DNS information to instances.</paragraph>
        <section ids="case-1-each-virtual-network-uses-unique-dns-resolver-s" names="case\ 1:\ each\ virtual\ network\ uses\ unique\ dns\ resolver(s)">
            <title>Case 1: Each virtual network uses unique DNS resolver(s)</title>
            <paragraph>In this case, the DHCP agent offers one or more unique DNS resolvers
                to instances via DHCP on each virtual network. You can configure a DNS
                resolver when creating or updating a subnet. To configure more than
                one DNS resolver, use a comma between each value.</paragraph>
            <bullet_list bullet="*">
                <list_item>
                    <paragraph>Configure a DNS resolver when creating a subnet.</paragraph>
                    <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ neutron subnet-create --dns-nameserver DNS_RESOLVER</literal_block>
                    <paragraph>Replace <literal>DNS_RESOLVER</literal> with the IP address of a DNS resolver reachable
                        from the virtual network. For example:</paragraph>
                    <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ neutron subnet-create --dns-nameserver 203.0.113.8,198.51.100.53</literal_block>
                    <note>
                        <paragraph>This command requires other options outside the scope of this
                            content.</paragraph>
                    </note>
                </list_item>
                <list_item>
                    <paragraph>Configure a DNS resolver on an existing subnet.</paragraph>
                    <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ neutron subnet-update --dns-nameserver DNS_RESOLVER SUBNET_ID_OR_NAME</literal_block>
                    <paragraph>Replace <literal>DNS_RESOLVER</literal> with the IP address of a DNS resolver reachable
                        from the virtual network and <literal>SUBNET_ID_OR_NAME</literal> with the UUID or name
                        of the subnet. For example, using the <literal>selfservice</literal> subnet:</paragraph>
                    <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ neutron subnet-update --dns-nameserver 203.0.113.8,198.51.100.53 selfservice</literal_block>
                </list_item>
            </bullet_list>
        </section>
        <section ids="case-2-all-virtual-networks-use-same-dns-resolver-s" names="case\ 2:\ all\ virtual\ networks\ use\ same\ dns\ resolver(s)">
            <title>Case 2: All virtual networks use same DNS resolver(s)</title>
            <paragraph>In this case, the DHCP agent offers the same DNS resolver(s) to
                instances via DHCP on all virtual networks.</paragraph>
            <bullet_list bullet="*">
                <list_item>
                    <paragraph>In the <literal>dhcp_agent.ini</literal> file, configure one or more DNS resolvers. To
                        configure more than one DNS resolver, use a comma between each value.</paragraph>
                    <literal_block highlight_args="{}" language="ini" linenos="False" xml:space="preserve">[DEFAULT]
dnsmasq_dns_servers = DNS_RESOLVER</literal_block>
                    <paragraph>Replace <literal>DNS_RESOLVER</literal> with the IP address of a DNS resolver reachable
                        from all virtual networks. For example:</paragraph>
                    <literal_block highlight_args="{}" language="ini" linenos="False" xml:space="preserve">[DEFAULT]
dnsmasq_dns_servers = 203.0.113.8, 198.51.100.53</literal_block>
                    <note>
                        <paragraph>You must configure this option for all eligible DHCP agents and
                            restart them to activate the values.</paragraph>
                    </note>
                </list_item>
            </bullet_list>
        </section>
        <section ids="case-3-all-virtual-networks-use-dns-resolver-s-on-the-host" names="case\ 3:\ all\ virtual\ networks\ use\ dns\ resolver(s)\ on\ the\ host">
            <title>Case 3: All virtual networks use DNS resolver(s) on the host</title>
            <paragraph>In this case, the DHCP agent offers the DNS resolver(s) in the
                <literal>resolv.conf</literal> file on the host running the DHCP agent via DHCP to
                instances on all virtual networks.</paragraph>
            <bullet_list bullet="*">
                <list_item>
                    <paragraph>In the <literal>dhcp_agent.ini</literal> file, enable advertisement of the DNS resolver(s)
                        on the host.</paragraph>
                    <literal_block highlight_args="{}" language="ini" linenos="False" xml:space="preserve">[DEFAULT]
dnsmasq_local_resolv = True</literal_block>
                    <note>
                        <paragraph>You must configure this option for all eligible DHCP agents and
                            restart them to activate the values.</paragraph>
                    </note>
                </list_item>
            </bullet_list>
        </section>
    </section>
</document>
